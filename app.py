import streamlit as st
import time

st.set_page_config(page_title="–û—Ä–≥–∞–Ω–∏–∫–∞–ª—ã“õ —Ö–∏–º–∏—è: 34 –°–∞–±–∞“õ", layout="wide")

# ---------------- SIDEBAR ----------------
st.sidebar.title("üìò –ú–ê–ó–ú“∞–ù–´")
lessons = [f"{i}-—Å–∞–±–∞“õ" for i in range(1, 35)]
lesson_selected = st.sidebar.selectbox("–°–∞–±–∞“õ—Ç—ã —Ç–∞“£–¥–∞“£—ã–∑", lessons)
mode = st.sidebar.radio("–†–µ–∂–∏–º", ["–û“õ—É—à—ã", "–ú“±“ì–∞–ª—ñ–º"])

# ---------------- DATA (5-10 –°–ê–ë–ê“ö–¢–ê–† “ö–û–°–´–õ–î–´) ----------------
lesson_data = {
    1: {"topic": "–°–∞–ø–∞–ª—ã“õ —Ä–µ–∞–∫—Ü–∏—è “±“ì—ã–º—ã", "theory": "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–¥—ã“õ —Ç–æ–ø—Ç–∞—Ä–¥—ã –∞–Ω—ã“õ—Ç–∞—É ”ô–¥—ñ—Å—Ç–µ—Ä—ñ.", "lab": ("Br‚ÇÇ", "–¢“Ø—Å—Å—ñ–∑–¥–µ–Ω—É", "–ê–ª–∫–µ–Ω –∞–Ω—ã“õ—Ç–∞–ª–¥—ã"), "colors": ["#A52A2A", "#FFFFFF"]},
    2: {"topic": "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–¥—ã“õ —Ç–æ–ø—Ç–∞—Ä", "theory": "–û—Ä–≥–∞–Ω–∏–∫–∞–ª—ã“õ –∑–∞—Ç—Ç–∞—Ä–¥—ã“£ –∂—ñ–∫—Ç–µ–ª—É—ñ.", "lab": ("Cu(OH)‚ÇÇ", "–ö”©–∫ —Ç“Ø—Å", "–°–ø–∏—Ä—Ç –∞–Ω—ã“õ—Ç–∞–ª–¥—ã"), "colors": ["#0000FF", "#4169E1"]},
    3: {"topic": "“ö–∞—É—ñ–ø—Å—ñ–∑–¥—ñ–∫ –µ—Ä–µ–∂–µ–ª–µ—Ä—ñ", "theory": "–ó–µ—Ä—Ç—Ö–∞–Ω–∞–¥–∞“ì—ã –∂“±–º—ã—Å –µ—Ä–µ–∂–µ—Å—ñ.", "lab": ("“ö“±—Ä–∞–ª–¥–∞—Ä", "“ö–∞—É—ñ–ø—Å—ñ–∑–¥—ñ–∫", "–î–∞–π—ã–Ω"), "colors": ["#CCCCCC", "#228B22"]},
    4: {"topic": "“ö–∞–Ω—ã“õ–ø–∞“ì–∞–Ω –±–∞–π–ª–∞–Ω—ã—Å", "theory": "–ê–ª–∫–µ–Ω–¥–µ—Ä –º–µ–Ω –∞–ª–∫–∏–Ω–¥–µ—Ä —Ä–µ–∞–∫—Ü–∏—è—Å—ã.", "lab": ("KMnO‚ÇÑ", "–¢“Ø—Å—Å—ñ–∑–¥–µ–Ω—É", "“ö–æ—Å –±–∞–π–ª–∞–Ω—ã—Å –±–∞—Ä"), "colors": ["#8B008B", "#FFFFFF"]},
    5: {
        "topic": "–ê–ª—å–¥–µ–≥–∏–¥—Ç–µ—Ä (–ö“Ø–º—ñ—Å –∞–π–Ω–∞)",
        "theory": "–ê–ª—å–¥–µ–≥–∏–¥—Ç–µ—Ä —Ç–æ—Ç—ã“ì—ã–ø, –∫–∞—Ä–±–æ–Ω “õ—ã—à“õ—ã–ª—ã–Ω–∞ –∞–π–Ω–∞–ª–∞–¥—ã.",
        "lab": ("AgNO‚ÇÉ + NH‚ÇÉ", "–ö“Ø–º—ñ—Å –∂–∞–ª–∞—Ç—ã–ª—É –ø–∞–π–¥–∞ –±–æ–ª–¥—ã", "–ê–ª—å–¥–µ–≥–∏–¥ —Ç–æ–±—ã –¥”ô–ª–µ–ª–¥–µ–Ω–¥—ñ"),
        "colors": ["#D3D3D3", "#C0C0C0"],
        "test": [("–ö“Ø–º—ñ—Å –∞–π–Ω–∞ —Ä–µ–∞–∫—Ç–∏–≤—ñ?", ["AgNO‚ÇÉ", "NaOH", "HCl"], 0)] * 10
    },
    6: {
        "topic": "–ö–∞—Ä–±–æ–Ω “õ—ã—à“õ—ã–ª–¥–∞—Ä—ã",
        "theory": "“ö—ã—à“õ—ã–ª–¥–∞—Ä–¥—ã“£ –º–µ—Ç–∞–ª–¥–∞—Ä–º–µ–Ω –∂”ô–Ω–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–º–µ–Ω —Ä–µ–∞–∫—Ü–∏—è—Å—ã.",
        "lab": ("–õ–∞–∫–º—É—Å", "“ö—ã–∑—ã–ª —Ç“Ø—Å–∫–µ ”©–∑–≥–µ—Ä—É", "“ö—ã—à“õ—ã–ª–¥—ã“õ –æ—Ä—Ç–∞"),
        "colors": ["#0000FF", "#FF0000"],
        "test": [("“ö—ã—à“õ—ã–ª–¥—ã“£ –±–µ–ª–≥—ñ—Å—ñ?", ["“ö—ã–∑–∞—Ä—É", "–ö”©–≥–µ—Ä—É", "–ì–∞–∑"], 0)] * 10
    },
    7: {
        "topic": "–ö”©–ø –∞—Ç–æ–º–¥—ã —Å–ø–∏—Ä—Ç—Ç–µ—Ä",
        "theory": "–ì–ª–∏—Ü–µ—Ä–∏–Ω —Å–∏—è“õ—Ç—ã —Å–ø–∏—Ä—Ç—Ç–µ—Ä–¥—ñ –∞–Ω—ã“õ—Ç–∞—É.",
        "lab": ("Cu(OH)‚ÇÇ", "–ê—à—ã“õ –∫”©–∫ –µ—Ä—ñ—Ç—ñ–Ω–¥—ñ", "–ì–ª–∏—Ü–µ—Ä–∞—Ç —Ç“Ø–∑—ñ–ª–¥—ñ"),
        "colors": ["#FFFFFF", "#0000FF"],
        "test": [("–ì–ª–∏—Ü–µ—Ä–∏–Ω —Ä–µ–∞–∫—Ç–∏–≤—ñ?", ["Cu(OH)‚ÇÇ", "FeCl‚ÇÉ", "Br‚ÇÇ"], 0)] * 10
    },
    8: {
        "topic": "–ù”ô—Ä—É—ã–∑–¥–∞—Ä (–ë–∏—É—Ä–µ—Ç —Ä–µ–∞–∫—Ü–∏—è—Å—ã)",
        "theory": "–ü–µ–ø—Ç–∏–¥—Ç—ñ–∫ –±–∞–π–ª–∞–Ω—ã—Å—Ç—ã –∞–Ω—ã“õ—Ç–∞—É.",
        "lab": ("NaOH + CuSO‚ÇÑ", "–ö“Ø–ª–≥—ñ–Ω —Ç“Ø—Å–∫–µ –±–æ—è–ª—É", "–ù”ô—Ä—É—ã–∑ –±–∞—Ä"),
        "colors": ["#3498db", "#8E44AD"],
        "test": [("–ë–∏—É—Ä–µ—Ç —Ç“Ø—Å—ñ “õ–∞–Ω–¥–∞–π?", ["–ö“Ø–ª–≥—ñ–Ω", "–°–∞—Ä—ã", "–ö”©–∫"], 0)] * 10
    },
    9: {
        "topic": "–ù”ô—Ä—É—ã–∑–¥–∞—Ä (–ö—Å–∞–Ω—Ç–æ–ø—Ä–æ—Ç–µ–∏–Ω)",
        "theory": "–ê—Ä–æ–º–∞—Ç—Ç—ã —Å–∞“õ–∏–Ω–∞—Å—ã –±–∞—Ä –Ω”ô—Ä—É—ã–∑–¥–∞—Ä–¥—ã –∞–Ω—ã“õ—Ç–∞—É.",
        "lab": ("HNO‚ÇÉ (–∫–æ–Ω—Ü)", "–°–∞—Ä—ã —Ç“±–Ω–±–∞", "–ù”ô—Ä—É—ã–∑ –∞–Ω—ã“õ—Ç–∞–ª–¥—ã"),
        "colors": ["#FFFFFF", "#FFFF00"],
        "test": [("–ö—Å–∞–Ω—Ç–æ–ø—Ä–æ—Ç–µ–∏–Ω —Ç“Ø—Å—ñ?", ["–°–∞—Ä—ã", "“ö—ã–∑—ã–ª", "–ê“õ"], 0)] * 10
    },
    10: {
        "topic": "–ö—Ä–∞—Ö–º–∞–ª–¥—ã –∞–Ω—ã“õ—Ç–∞—É",
        "theory": "–ü–æ–ª–∏—Å–∞—Ö–∞—Ä–∏–¥—Ç–µ—Ä–¥—ñ“£ –∏–æ–¥–ø–µ–Ω —Ä–µ–∞–∫—Ü–∏—è—Å—ã.",
        "lab": ("I‚ÇÇ (–ò–æ–¥)", "–ö”©–∫ —Ç“Ø—Å–∫–µ –±–æ—è–ª—É", "–ö—Ä–∞—Ö–º–∞–ª –±–∞—Ä"),
        "colors": ["#FFA500", "#00008B"],
        "test": [("–ö—Ä–∞—Ö–º–∞–ª“ì–∞ –∏–æ–¥ “õ–æ—Å“õ–∞–Ω–¥–∞?", ["–ö”©–≥–µ—Ä–µ–¥—ñ", "“ö—ã–∑–∞—Ä–∞–¥—ã", "–¢“Ø—Å—Å—ñ–∑–¥–µ–Ω–µ–¥—ñ"], 0)] * 10
    }
}

# ---------------- UI FUNCTIONS ----------------
def run_lab(reagents, observation, conclusion, colors):
    st.subheader("üî¨ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è–ª—ã“õ —Ç”ô–∂—ñ—Ä–∏–±–µ")
    st.markdown("""
    <style>
    .tube-container { display: flex; justify-content: center; }
    .tube { width: 50px; height: 150px; border: 3px solid white; border-bottom-radius: 20px; 
            border-bottom-left-radius: 25px; border-bottom-right-radius: 25px; position: relative; overflow: hidden; }
    .liquid { position: absolute; bottom: 0; width: 100%; transition: all 1.5s; }
    </style>
    """, unsafe_allow_html=True)
    
    col1, col2 = st.columns(2)
    with col1:
        st.write(f"**–†–µ–∞–∫—Ç–∏–≤:** {reagents}")
        if st.button("üß™ –†–µ–∞–∫—Ü–∏—è–Ω—ã –±–∞—Å—Ç–∞—É"):
            tube = st.empty()
            for i in range(0, 101, 10):
                curr_color = colors[0] if i < 50 else colors[1]
                tube.markdown(f'<div class="tube-container"><div class="tube"><div class="liquid" style="height:{i}%; background:{curr_color};"></div></div></div>', unsafe_allow_html=True)
                time.sleep(0.1)
            st.success(f"–ë–∞“õ—ã–ª–∞—É: {observation}")
            st.info(f"“ö–æ—Ä—ã—Ç—ã–Ω–¥—ã: {conclusion}")
    with col2:
        
        

# ---------------- MAIN RENDER ----------------
lesson_num = int(lesson_selected.split("-")[0])
data = lesson_data.get(lesson_num)

if data:
    st.header(f"‚Ññ{lesson_num} –°–∞–±–∞“õ: {data['topic']}")
    st.write(data["theory"])
    run_lab(data["lab"][0], data["lab"][1], data["lab"][2], data["colors"])
    
    st.subheader("üìù –¢–µ—Å—Ç —Ç–∞–ø—Å—ã—Ä–º–∞—Å—ã")
    if "test" in data:
        for idx, (q, opts, ans) in enumerate(data["test"]):
            st.radio(f"{idx+1}. {q}", opts, key=f"t_{lesson_num}_{idx}")
else:
    st.warning(f"‚Ññ{lesson_num} —Å–∞–±–∞“õ—Ç—ã“£ –º–∞–∑–º“±–Ω—ã ”ô–∑—ñ—Ä–ª–µ–Ω—É–¥–µ... (Lesson {lesson_num} under development)")

st.markdown("---")
st.caption("¬© Chemistry Digital Lab 2026")
